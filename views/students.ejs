<%- include("./partials/head.ejs") %>
  <%- include("./partials/header.ejs") %>

    <section class="container">
      <div class="row">
        <div class="col s6">
          <p>Inicio > Escolas > <b>Alunos</b></p>
          <h1 class="text-medium">
            <%= students[0].school_name %>
          </h1>
          <h2 class="text-bold blue-grey-text">Ajude a encher a mochila de:</h2>
        </div>
        <div class="col s6">

          <div class="city-search-bar grey lighten-1 my">
            <input placeholder="Digite o nome da sua cidade..." id="city-autocomplete" type="text">
            <button id="search-button" class="btn waves-effect waves-light" type="submit" name="action">
              <i class="material-icons">search</i>
            </button>
          </div>

        </div>
      </div>

      <div class="row my">
        <% students.forEach((student)=> { %>
          <%- include("./components/student-card.ejs", {student: student}) %>
            <% }); %>
      </div>
    </section>


    <!--Modal-->

    <% materials.forEach((materialList)=> { %>
      <div id="<%= materialList.id %>" class="modal modal-fixed-footer">
        <div id="content<%= materialList.id %>" class="modal-content center-align">
          <h2 class="text-bold blue-grey-text">Lista de Materiais</h2>
          <div class="materials-list">
            <ul class="collection">
              <% if (materialList.products_list.length) { %>
                <% materialList.products_list.forEach((material)=> { %>
                  <li id="<%= material.Codigo %>" onclick="select('<%= material.Codigo %>')"
                    class="collection-item avatar">

                    <img src="<%= material.image %>" alt="" class="circle">
                    <h6><b>
                        <%= material.Grupo %>
                      </b></h6>

                    <label class="secondary-content">
                      <input id="input_<%= material.Codigo %>" type="checkbox"
                        onclick="event.stopImmediatePropagation();" name="<%= material.Codigo %>" autocomplete="off" />
                      <span></span>
                    </label>
                  </li>
                  <% }) %>
                    <% } %>
            </ul>
          </div>
        </div>

        <div id="agree<%= materialList.id %>" class="thank-you-content center-align">
          <h2 class="text-bold blue-grey-text">Agradecemos sua contribuição!</h2>
          <img src="/assets/thanks-mochi.png" alt="Thank you!">
        </div>

        <div class="modal-footer">
          <div class="buttons center-align">
            <a href="#" class="modal-close waves-effect waves-light btn-flat">Cancelar</a>
            <a href="#" id="<%= materialList.id %>" onclick="modalEffect('<%= materialList.id %>')"
              class="donate-button waves-effect waves-light btn ambar">Doar materiais</a>
          </div>

        </div>

        <div class="modal-footer" style="display:none;" id="agreeFooter<%= materialList.id %>">
          <a href="#!" class="modal-close waves-effect waves-green btn-flat">Agree</a>
        </div>

        <div class="secondary-modal-footer">
          <div class="buttons center-align">
            <a href="/" class="return-home-button waves-effect waves-light btn ambar">Voltar a home</a>
          </div>
        </div>
      </div>

      <% }); %>
      
      <script>

          const openModalButton = document.querySelector('.open-modal-button');
          const modalContent = document.querySelector('.modal-content');
          const donateButton = document.querySelector('.donate-button');
          const thankYouContent = document.querySelector('.thank-you-content');  
          const modalFooter = document.querySelector('.modal-footer');
          const secondaryModalFooter = document.querySelector('.secondary-modal-footer');      

          openModalButton.addEventListener('click', showMaterialList);

          function showMaterialList() {
            thankYouContent.classList.remove("show");
            thankYouContent.classList.add("hide");
            modalContent.classList.add("show");
            modalContent.classList.remove("hide");
            secondaryModalFooter.classList.add('hide');
            secondaryModalFooter.classList.remove('show');
            modalFooter.classList.remove('hide');
            modalFooter.classList.add('show');
          } 

          donateButton.addEventListener('click', showthankYouContent);

          function showthankYouContent() {
            thankYouContent.classList.remove("hide");
            thankYouContent.classList.add("show");
            modalContent.classList.remove("show");
            modalContent.classList.add("hide");
            modalFooter.classList.add("hide");
            secondaryModalFooter.classList.remove("hide");
            secondaryModalFooter.classList.add("show");
          }

        </script>

        <%- include("./partials/footer.ejs") %>
